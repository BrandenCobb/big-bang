{{- if or .Values.logging.enabled .Values.clusterAuditor.enabled }}
{{- include "values-secret" (dict "root" $ "package" .Values.logging "name" "ek" "defaults" (include "bigbang.defaults.logging" .)) }}
{{- end }}

{{- define "bigbang.defaults.logging" -}}
hostname: {{ .Values.hostname }}
istio:
  enabled: {{ .Values.istio.enabled }}

{{- with .Values.logging.sso }}
{{- if .enabled }}
sso:
  enabled: {{ .enabled }}
  client_id: {{ .client_id | quote }}
  client_secret: {{ .client_secret | default "no-secret" }}
  oidc:
    {{- if $.Values.logging.sso.oidc }}
    host: {{ .oidc.host | default $.Values.sso.oidc.host | quote }}
    realm: {{ .oidc.realm | default $.Values.sso.oidc.realm | quote }}
    {{- else }}
    host: {{ $.Values.sso.oidc.host | quote }}
    realm: {{ $.Values.sso.oidc.realm | quote }}
    {{- end }}
  {{- /* Optional fields should be nil checked */ -}}
  {{- if .issuer }} 
  issuer: {{ .issuer | quote }} 
  {{- end }}
  {{- if .auth_url }} 
  auth_url: {{ .auth_url | quote }} 
  {{- end }}
  {{- if .token_url }} 
  token_url: {{ .token_url | quote }} 
  {{- end }}
  {{- if .userinfo_url }} 
  userinfo_url: {{ .userinfo_url | quote }} 
  {{- end }}
  {{- if .jwkset_url }} 
  jwkset_url: {{ .jwkset_url | quote }} 
  {{- end }}
  {{- if .claims_principal }} 
  claims_principal: {{ .claims_principal | quote }} 
  {{- end }}
  {{- if .claims_principal_pattern }} 
  claims_principal_pattern: {{ .claims_principal_pattern | quote }} 
  {{- end }}
  {{- if .requested_scopes }}
  requested_scopes:
    {{- range .requested_scopes }}
    - {{ . | quote }}
    {{- end }}
  {{- end }}
  {{- if .signature_algorithm }} 
  signature_algorithm: {{ .signature_algorithm | quote }} 
  {{- end }}
  {{- if .endsession_url }} 
  endsession_url: {{ .endsession_url | quote }} 
  {{- end }}
  {{- if .claims_group }} 
  claims_group: {{ .claims_group | quote }} 
  {{- end }}
  {{- if .claims_mail }} 
  claims_mail: {{ .claims_mail | quote }} 
  {{- end }}
{{- end }}
{{- end }}

kibana:
  version: 7.9.2
  imagePullSecrets:
    - name: private-registry

elasticsearch:
  version: 7.9.2
  imagePullSecrets:
    - name: private-registry
{{- end -}}
